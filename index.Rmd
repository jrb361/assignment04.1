---
title: "Assignment #4"
author: "Julia Buschmann"
date: "2/25/2022"
output: pdf_document
urlcolor: blue
source: https://usa.ipums.org/usa-action/data_requests/download
---

Aesthetic mappings: x position, y position, line type, colors, transparency
Non-aesthetic mappings: outside aes, like theme minimal, facet wrap

To commit to Github:git add (file), git commit -m "comment", git push origin main

```{r include=FALSE}
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(haven)
library(ipumsr)
library(ggplot2)
library(dplyr)
library(srvyr)
library(grid)
theme_set(theme_classic())

def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$size != "normalsize", paste0("\n \\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})
```

\begin{center}
\Huge{PPOL 670 | Assignment 3}

\Huge{Applied Introduction to R's Tidyverse}
\end{center}

\vspace{0.1in}

```{r}
ddi <- read_ipums_ddi("cps_00002.xml")
data <- read_ipums_micro(ddi)
```

\newpage

# Visualization #1
### The below graph depicts the enrollment in Medicaid, differentiated by sex, for years 2016 through 2021. 
```{r}
data %>%
  group_by(YEAR) %>%
  filter (HIMCAIDLY == 2) %>%
  mutate(
    Sex = case_when(
      SEX == 1 ~ "Male",
      SEX == 2 ~ "Female"
    ))%>%
  ggplot +
  geom_bar(mapping = aes(x = factor(YEAR), fill = factor(Sex)), position = "dodge") +
  labs(title="Medicaid Enrollment By Year, Differentiated By Sex", 
       caption="Source: IPUMS Micro Data",
       x = "Year",
       y = "Number of People Enrolled",
       fill = "Sex")
```

\newpage

# Visualization #2
### Scatterplot with the different types of physical difficulties, with smooth lines for insurance type, y-axis is the number of people
```{r eval = FALSE}
data%>%
  filter(YEAR == 2021)%>%
  mutate(
    month = case_when(
      MONTH == 1 ~ "January",
      MONTH == 2 ~ "February",
      MONTH == 3 ~ "March", 
      MONTH == 4 ~ "April",
      MONTH == 5 ~ "May",
      MONTH == 6 ~ "June",
      MONTH == 7 ~ "July",
      MONTH == 8 ~ "August", 
      MONTH == 9 ~ "September", 
      MONTH == 10 ~ "October", 
      MONTH == 11 ~ "November",
      MONTH == 12 ~ "December"
    ))%>%
  mutate(
    instype = case_when(
      PRVTCOVNW == 2 ~ "Private Insurance",
      GRPCOVNW == 2 ~ "Employer Sponsored Insurance",
      MRKCOVNW == 2 ~ "Subsidized Marketplace Insurance",
      HIMCARENW == 2 ~ "Medicare",
      HIMCAIDNW == 2 ~ "Medicaid or CHIP"
    ))%>%
  summarize(instype = n())%>%
  group_by(instype)%>%
    ggplot(aes(x = month)) +
    geom_smooth(mapping = aes(y = instype))+
    labs(title = "Prevelance of Different Types of Health Insurance in 2021")+

```

\newpage

#Visualization #3
### A histogram demonstrating the age of Medicaid enrollees. Unsurprisingly, we see that the majority of enrollees are younger than 18. More than half of all births in the US are among Medicaid enrollees, and in some states, kids at certain income levels are eligible (via CHIP) when their parents may not be.
```{r}
data %>%
  filter(YEAR == 2021) %>%
  filter(AGE <= 79)%>%
  filter(HIMCAIDLY == 2) %>%
  ggplot +
  geom_histogram(aes(x = AGE), 
                 binwidth = .1)+
  labs(title="Number of individuals enrolled in Medicaid, by Age, in 2021", 
       subtitle = "Due to coding methods, an accurate count of individual 80 years and older is not available. 
       They have been excluded from the below graph.",
       caption="Source: IPUMS Micro Data",
       x = "Age of Medicaid Enrollee",
       y = "Number of People Enrolled (thousands)")

```

\newpage 

# Visualization #4
### Columns with the number of privately insured individuals, with an overlay of points showing the number of people with ESI coverage; expecting the ESI coverage to be less but consistently track the amount for private coverage
```{r eval = FALSE}
data %>%
  filter(YEAR == 2021)%>%
  filter(PRVTCOVNW == 2 | GRPCOVNW == 2)%>%
  filter(AGE <= 79)%>%
  group_by(AGE)%>%
  summarize(PRVTCOVNW = sum(PRVTCOVNW), GRPCOVNW = sum(GRPCOVNW))%>%
  ggplot +
  geom_col(mapping = aes(x = AGE, y = PRVTCOVNW, fill = "skyblue"))+
  labs(title="Number of Individuals Enrolled in Private Coverage, by Age, in 2021", 
       subtitle = "55",
       caption="Source: IPUMS Micro Data",
       x = "Age of Policy Holder",
       y = "Number of Individuals with Private Insurance (thousands)") +
  geom_point(mapping = aes(x = AGE, y = GRPCOVNW))

```

